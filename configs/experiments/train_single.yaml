# Single Model Training Experiment
# Train a single PIDS model on a dataset

experiment_name: train_magic_custom
experiment_type: single_model

# Model configuration
model:
  name: magic
  config: configs/models/magic.yaml
  
  # Model-specific overrides
  overrides:
    architecture:
      num_hidden: 256
      num_layers: 4
    training:
      learning_rate: 0.0005
      num_epochs: 300

# Dataset configuration
dataset:
  name: custom_soc
  config: configs/datasets/custom_soc.yaml
  
  # Dataset-specific overrides
  overrides:
    preprocessing:
      normalize_features: true
    split:
      train_ratio: 0.7
      val_ratio: 0.15
      test_ratio: 0.15

# Training configuration
training:
  max_epochs: 300
  batch_size: 1            # Model-specific
  
  # Optimization
  optimizer: adam
  learning_rate: 0.0005
  weight_decay: 0.0
  grad_clip: 1.0
  
  # Learning rate scheduling
  scheduler:
    type: reduce_on_plateau
    mode: max
    factor: 0.5
    patience: 15
    min_lr: 0.00001
  
  # Early stopping
  early_stopping:
    enabled: true
    patience: 50
    min_delta: 0.001
    metric: auroc
    mode: max
    
  # Regularization
  dropout: 0.1
  label_smoothing: 0.0
  
  # Device and parallelism
  device: cuda
  mixed_precision: false   # Use automatic mixed precision
  num_workers: 4
  pin_memory: true
  
  # Reproducibility
  seed: 42
  deterministic: true

# Evaluation configuration
evaluation:
  # Evaluation frequency
  eval_every: 5            # Evaluate every N epochs
  eval_on_train: false     # Also evaluate on training set
  
  # Metrics
  metrics:
    - auroc
    - auprc
    - f1_score
    - precision
    - recall
    - accuracy
    
  # Save predictions
  save_predictions: true
  predictions_dir: results/predictions/
  
# Checkpointing
checkpointing:
  save_dir: checkpoints/magic_custom/
  save_frequency: 10       # Save every N epochs
  save_best_only: false
  save_last: true
  metric: auroc
  mode: max
  
# Logging
logging:
  # Console logging
  console_log_level: INFO
  
  # File logging
  log_dir: logs/
  log_file: magic_custom.log
  
  # TensorBoard (optional)
  tensorboard:
    enabled: true
    log_dir: runs/magic_custom/
    log_every: 10
    
  # Weights & Biases (optional)
  wandb:
    enabled: false
    project: pids_framework
    entity: null
    name: magic_custom_soc
    
# Visualization
visualization:
  enabled: true
  plot_dir: results/plots/magic_custom/
  
  plots:
    - training_loss
    - validation_metrics
    - learning_rate
    - embeddings_2d        # t-SNE/UMAP of embeddings
    
# Data augmentation (if supported)
augmentation:
  enabled: false
  techniques:
    - node_dropping: 0.1
    - edge_perturbation: 0.05
    
# Results
results:
  output_dir: results/magic_custom/
  save_model: true
  save_embeddings: true
  generate_report: true
  
# Debugging
debug:
  enabled: false
  check_gradients: false
  log_parameter_stats: false
  detect_anomaly: false    # PyTorch autograd anomaly detection
